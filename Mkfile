PCRE_CFLAGS 	  	= `{pcre-config --cflags}
PCRE_LDFLAGS 		= `{pcre-config --libs}

POSTGRES_CFLAGS 	= -I`{pg_config --includedir}
POSTGRES_LDFLAGS 	= -L`{pg_config --libdir} -lecpg -lpq

CC			= cc
CFLAGS			= $PCRE_CFLAGS $POSTGRES_CFLAGS -Wall -std=c99 

all:QV: extract ecpgtest

<.depend

.depend: ecpgtest.c extract.c extract.h store.h store.c
  $CC $CFLAGS -E -MM $prereq > $target

%.c: %.pgc
  ecpg $stem.pgc -o $stem.c

%.o: %.c
  $CC $CFLAGS -c $stem.c -o $stem.o

extract: extract.o store.o
  $CC $PCRE_LDFLAGS $POSTGRES_LDFLAGS $prereq -o $target

ecpgtest: ecpgtest.o store.o
  $CC $PCRE_LDFLAGS $POSTGRES_LDFLAGS $prereq -o $target

clean:V:
  rm -f *.o store.c ecpgtest extract fgetstest